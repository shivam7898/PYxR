# R List & Python Dictionary {#list-dict-p03}

```{r 'setup', include=FALSE}
################################################################################
source("_common.R")
if(FALSE) c("lobstr") |> 
  lapply(library, character.only=TRUE)
```

- R `list` :

- Python `dict` (Dictionary) :
  - `dict` : Literal `{}`, Ordered, Mutable, No Duplicates, [Refer](https://docs.python.org/3/library/stdtypes.html#mapping-types-dict)

> Dictionaries compare equal if and only if they have the same (key, value) pairs (regardless of ordering).[Refer](https://docs.python.org/3/library/stdtypes.html#mapping-types-dict)  

- `dict` is ordered
  - Essentially it means 'insertion ordered' which is different from ordered like `OrderedDict`
  - Equality comparisons with `OrderedDict` are order sensitive but this is not the case for `dict`
- [Refer](https://docs.python.org/3.9/whatsnew/3.9.html#dictionary-merge-update-operators)

## Basic

```{r 'R-List', decorate=TRUE}
aa = list()                                       #Empty List
str(aa)
aa <- list("a" = 11L, "b" = 22L)                   #Normal List
str(aa)

bb <- setNames(as.list(c(11L, 22L, 33L)), nm = c("a", "b", "c")) #Named List
str(bb)

# R List equality comparison is order sensitive (unlike Python Dictionary)
dd <- list("b" = 22L, "a" = 11L)
stopifnot(!identical(aa, dd))                     #Order Sensitive
stopifnot(identical(aa[order(names(aa))], dd[order(names(dd))])) #Sort, Compare

ee <- list("c" = 33L, "b" = 999L)
xx <- c(aa, ee)                         #Merge, keep duplicates (Avoid)
str(xx)
xx <- modifyList(aa, val = ee)          #Merge, overwrite duplicates
str(xx)
xx <- within(xx, rm("b"))               #Delete, Key not found Error
xx[c("b")] <- NULL                      #Delete, No Key error
xx <- xx[setdiff(names(xx), "bb")]      #Delete, No Key error
str(xx)

# Merge, overwrite duplicates: This may result in position change of key
str(c(aa, ee)[!duplicated(c(names(aa), names(ee)), fromLast = TRUE)])

ff <- modifyList(aa, val = ee)          #Merge, overwrite duplicates
ff$b <- 22L
stopifnot(identical(bb, ff))
```

```{python 'Y-Dict', decorate=TRUE}
pp = {}                                           #Empty Dictionary
print(f"{type(pp) = } | {len(pp) = } | {pp = }")
pp = {"a": 11, "b": 22}                           #Normal Dictionary
print(f"{len(pp)=}, {pp = }")

qq = {zip(["a", "b", "c"], [11, 22, 33])}         #zip() creates set with {}
assert(type(qq) is set)
qq = dict(zip(["a", "b", "c"], [11, 22, 33]))     #zip() needs dict()
print(f"{len(qq)=}, {qq = }")

# Python Dictionary equality comparison is order insensitive (unlike R List)
ss = {"b": 22, "a": 11}
assert(pp == ss)                                  #Ignore Key Position
assert(not(list(ss.items()) == list(pp.items()))) #Consider Key Position

tt = {"c": 33, "b": 999}
pp.update(tt)                           #Merge in-place, Last seen overwrite
print(f"{len(pp)=}, {pp = }")
pp.update({"b": 22}) 
del pp["c"]                   #Delete in-place, return None, Key not found Error
tt.pop("b")                   #Pop in-place, return value, Key not found Error
tt.pop("b", None)             #Pop in-place, return value, No Key error
tt["b"] = 999                           #Add element using subscript notation
print(f"{len(pp)=}, {pp = }")
print(f"{len(tt)=}, {tt = }")

uu = {**pp, **tt, **{"b": 22}}          #Merge using **, Last seen overwrite
assert(qq == uu)

vv = pp | tt | {"b": 22}                #Merge using | , Last seen overwrite
assert(qq == vv)

ww = copy.deepcopy(pp)
ww |= tt                      #Update in-place using |= , Last seen overwrite
ww |= {"b": 22}
assert(qq == ww)

```

```{r 'R-Compare-List-Dict', decorate=TRUE, include=FALSE}
bb_y <- py$qq                           #Convert Python dictionary to R List
str(bb_y)
stopifnot(identical(bb, bb_y))          #These are Identical
```

```{python 'Y-Compare-List-Dict', decorate=TRUE, include=FALSE}
qq_r = r.bb                             #Convert R List to Python dictionary
print(f"{len(qq_r)=}, {qq_r = }")
assert(qq == qq_r)                      #These are Identical

```

## Nested

```{r 'R-List-Nest', decorate=TRUE}
aa <- list("a" = 11L, "b" = 22L)
bb <- list("c" = 33L, "d" = 44L, "e" = aa)         #Nested List
str(bb)

```

```{python 'Y-Dict-Nest', decorate=TRUE}
pp = {"a": 11, "b": 22}
qq = {"c": 33, "d": 44, "e": pp}                  #Nested Dictionary
print(f"{len(qq)=}, {qq = }")

```

```{r 'R-Compare-List-Dict-Nest', decorate=TRUE, include=FALSE}
bb_y <- py$qq                           #Convert Python dictionary to R List
str(bb_y)
stopifnot(identical(bb, bb_y))          #These are Identical
```

```{python 'Y-Compare-List-Dict-Nest', decorate=TRUE, include=FALSE}
qq_r = r.bb                             #Convert R List to Python dictionary
print(f"{len(qq_r)=}, {qq_r = }")
assert(qq == qq_r)                      #These are Identical

```

## With Multiple DataTypes

```{r 'R-List-Multi', decorate=TRUE}
aa_lst <- list(11L, 22L)                #Unnamed List
bb_lst <- list(a = 11L, b = 22L)        #Named List
dd_vec <- c(11L, 22L)                   #Unnamed Vector

ee <- list(a = 11L, b = "x", c = FALSE, d = NULL, 
           e = aa_lst, f = dd_vec, g = bb_lst)
```

```{python 'Y-Dict-Multi', decorate=TRUE}
# Exclude Python sets because these are converted to R Environment
#tt_set = {11, 22}            # Set: Unordered, Mutable
pp_tup = (11, 22)             # Tuple: Ordered, Immutable | Unnamed List
qq_lst = [11, 22]             # List: Ordered, Mutable | Vector
ss_dic = {"a": 11, "b": 22}   # Dict: Ordered, Mutable | Named List

uu = {"a": 11, "b": "x", "c": False, "d": None, 
      "e": pp_tup, "f": qq_lst, "g": ss_dic}
print("\n".join([k + " : " + str(type(uu[k]).__name__) + " : " + str(v) 
                for k, v in uu.items()]))

```

```{r 'R-Compare-List-Dict-Multi', decorate=TRUE, include=FALSE}
ee_y <- py$uu                           #Convert Python dictionary to R List
str(ee_y)
stopifnot(identical(ee, ee_y))          #These are Identical
```

```{python 'Y-Compare-List-Dict-Multi', decorate=TRUE, include=FALSE}
uu_r = r.ee                             #Convert R List to Python dictionary
uu_r["e"] = tuple(uu_r["e"])            #List to Tuple
print("\n".join([k + " : " + str(type(uu_r[k]).__name__) + " : " + str(v) 
                for k, v in uu_r.items()]))
assert(uu == uu_r)                      #These are Identical

```


